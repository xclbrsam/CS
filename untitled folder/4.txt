-- Enable output display
SET SERVEROUTPUT ON;
SET VERIFY OFF;

-- Create the marks table
CREATE TABLE marks (
    rollno NUMBER(10),
    name VARCHAR2(20),
    sub1 NUMBER,
    sub2 NUMBER,
    sub3 NUMBER,
    sub4 NUMBER,
    sub5 NUMBER
);

-- Insert sample data
INSERT INTO marks VALUES (1, 'Karishma', 200, 250, 260, 270, 150);
INSERT INTO marks VALUES (2, 'Mayuri',   210, 220, 230, 240, 250);
INSERT INTO marks VALUES (3, 'Asim',     250, 260, 270, 280, 290);
INSERT INTO marks VALUES (4, 'Vaishnavi',180, 190, 200, 220, 250);

-- Check data
SELECT * FROM marks;

-- Create output tables
CREATE TABLE stud_marks (
    rollno NUMBER(10),
    name VARCHAR2(20),
    total_marks NUMBER(10)
);

CREATE TABLE result (
    rollno NUMBER(10),
    name VARCHAR2(20),
    class VARCHAR2(30)
);

-- Create procedure
CREATE OR REPLACE PROCEDURE proc_grade
IS
    n NUMBER(10);
    i NUMBER(10) := 0;

    rollnol NUMBER(10);
    namel VARCHAR2(30);
    totall NUMBER(10);
    classl VARCHAR2(30);

    s1 NUMBER;
    s2 NUMBER;
    s3 NUMBER;
    s4 NUMBER;
    s5 NUMBER;
BEGIN
    SELECT COUNT(*) INTO n FROM marks;

    LOOP
        i := i + 1;

        BEGIN
            SELECT rollno, name, sub1, sub2, sub3, sub4, sub5
            INTO rollnol, namel, s1, s2, s3, s4, s5
            FROM marks
            WHERE rollno = i;
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                EXIT;
        END;

        totall := s1 + s2 + s3 + s4 + s5;

        IF totall BETWEEN 990 AND 1500 THEN
            classl := 'DISTINCTION';
        ELSIF totall BETWEEN 900 AND 989 THEN
            classl := 'FIRST CLASS';
        ELSIF totall BETWEEN 825 AND 899 THEN
            classl := 'HIGHER SECOND CLASS';
        ELSE
            classl := 'PASS CLASS';
        END IF;

        INSERT INTO stud_marks VALUES (rollnol, namel, totall);
        INSERT INTO result VALUES (rollnol, namel, classl);

        IF i >= n THEN
            EXIT;
        END IF;
    END LOOP;

    DBMS_OUTPUT.PUT_LINE('Procedure executed successfully!');
END;
/




-----Executing the procedure
EXECUTE proc_grade;

SELECT * FROM stud_marks;
SELECT * FROM result;
